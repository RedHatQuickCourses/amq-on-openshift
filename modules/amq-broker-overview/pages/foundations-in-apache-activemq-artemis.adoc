= Foundations in Apache ActiveMQ Artemis

This module provides a deep dive into the foundational technology behind Red Hat AMQ Broker: *Apache ActiveMQ Artemis*. Understanding Artemis is crucial for effectively deploying, configuring, and managing AMQ Broker instances, especially in advanced scenarios.

== Introduction to Apache ActiveMQ Artemis

Apache ActiveMQ Artemis is a high-performance, non-blocking, asynchronous messaging system developed by the Apache Software Foundation. It serves as the upstream project that Red Hat AMQ Broker is based upon. Before it became ActiveMQ Artemis, it was known as HornetQ, a highly regarded messaging project from JBoss. Its adoption into the ActiveMQ family brought together robust features and a vibrant community, culminating in its current form.

Artemis is designed to be lightweight, fast, and highly reliable, making it an excellent choice for demanding enterprise messaging requirements. It aims to provide maximum throughput and minimal latency while ensuring message durability and high availability. It's a cornerstone technology for applications requiring robust, scalable, and high-performance message passing.

== Core Principles and Architecture

At its heart, ActiveMQ Artemis is built with a focus on efficiency and robustness. Key architectural principles include:

*   *Asynchronous Design*: Artemis leverages an asynchronous, non-blocking architecture throughout its core, from network communication to disk I/O. This design allows it to handle a large number of concurrent connections and messages with minimal thread contention and high throughput, making it highly efficient for modern distributed systems.
*   *Pluggable Persistence*: Message durability is a cornerstone of enterprise messaging. Artemis offers flexible persistence options, primarily using a highly optimized, custom *journal file store* by default. This journal is designed for extremely fast, synchronous disk writes, ensuring messages are never lost even in the event of a broker crash. It also supports *JDBC persistence* for integration with relational databases, offering an alternative for environments that prefer existing database infrastructure for message storage.
*   *Multi-Protocol Support (Native Implementation)*: Unlike some brokers that rely on protocol converters or proxies, Artemis natively implements a wide range of standard messaging protocols directly into its core. This native support reduces overhead, enhances performance, and provides seamless interoperability. These protocols include:
    ** *AMQ Core Protocol (OpenWire-compatible)*: The high-performance, low-latency native protocol primarily used by Java clients.
    ** *AMQP 1.0*: The Advanced Message Queuing Protocol, an open standard for interoperable, reliable messaging across different platforms and programming languages.
    ** *MQTT*: Message Queuing Telemetry Transport, a lightweight publish/subscribe protocol ideal for IoT, mobile, and constrained environments.
    ** *STOMP*: Simple (or Streaming) Text Oriented Message Protocol, a text-based wire protocol often used by web clients and scripting languages.
    ** *JMS*: Java Message Service, a Java API standard for creating, sending, receiving, and reading messages. Artemis provides a robust and fully compliant JMS implementation.
*   *Modular Design*: Artemis is designed with a modular architecture, allowing components to be swapped or extended. This flexibility is key to its adaptability and the ability for Red Hat to build AMQ Broker on top of it, adding enterprise-specific features and optimizations.

== Key Features

Beyond its core principles, Apache ActiveMQ Artemis offers a rich set of features critical for modern messaging infrastructures:

*   *High Performance*: Benchmarked to deliver extremely high message throughput and low latency, even under heavy load and with millions of queues and topics. Its non-blocking architecture and optimized persistence contribute significantly to this performance.
*   *High Availability (HA) and Clustering*: Provides robust mechanisms for ensuring message delivery and broker availability, making it suitable for mission-critical applications:
    ** *Shared Store HA*: Multiple broker instances share a single persistent store (e.g., a shared file system or database), with one instance active and others acting as hot standbys. If the active broker fails, a standby quickly takes over.
    ** *Replicated HA*: Broker instances replicate their entire state (messages, queues, subscriptions) to each other, forming a synchronous or asynchronous cluster without relying on a shared store. This provides resilience against storage failures.
    ** *Broker Federation*: Connects multiple independent brokers, allowing messages to flow between them across different networks, data centers, or cloud regions, enabling distributed messaging topologies.
*   *Flexible Addressing Model*: Supports both *anycast* (point-to-point messaging, typically with queues) and *multicast* (publish/subscribe messaging, typically with topics) message routing. It provides powerful address settings to control message behavior, expiration, dead-letter queues, message re-delivery, and more, offering granular control over message flow.
*   *Security*: Comprehensive security features are built into Artemis, including pluggable authentication mechanisms (e.g., JAAS, LDAP), role-based access control (RBAC) to define users, roles, and permissions for broker resources, and SSL/TLS encryption for securing client-broker and inter-broker communication.
*   *Management and Monitoring*: Provides extensive management capabilities via JMX (Java Management Extensions), a web-based console (Hawtio, which is integrated into AMQ Broker), and a powerful command-line interface for administration and monitoring of broker metrics, queues, topics, and connections.

== Relationship with Red Hat AMQ Broker

Red Hat AMQ Broker is Red Hat's enterprise-grade, fully supported distribution of Apache ActiveMQ Artemis. While the core messaging technology and many features originate from Artemis, Red Hat AMQ Broker provides significant additional value through:

*   *Enterprise Support*: Comprehensive, 24/7 Red Hat support, ensuring reliability and access to expert assistance for critical production deployments.
*   *Certified Builds*: Rigorously tested and certified builds of Artemis, ensuring stability, security, and compatibility with other Red Hat products and enterprise environments.
*   *Integration with Red Hat Ecosystem*: Seamless integration with other Red Hat products like OpenShift Container Platform (via Operators), Red Hat Fuse, and Red Hat Process Automation Manager, leveraging Red Hat's tooling and expertise for streamlined deployments and management.
*   *Long-Term Maintenance*: Red Hat provides stable release cycles, extensive bug fixes, security patches, and backports, offering a predictable and secure platform suitable for long-term enterprise application development.

When you deploy Red Hat AMQ Broker, you are deploying a hardened, enterprise-ready version of Apache ActiveMQ Artemis, carefully packaged and optimized for Red Hat's ecosystem, particularly OpenShift.

== Hands-on Activity: Verifying the Artemis Core

Even when working with Red Hat AMQ Broker, the underlying technology is Apache ActiveMQ Artemis. It's often useful to observe its startup logs to confirm the version and identify the core components at work.

.Objective
Identify the Apache ActiveMQ Artemis version and confirm its startup messages within the AMQ Broker logs. This activity will demonstrate how the core Artemis project manifests within the Red Hat AMQ Broker product.

.Steps

.  **Observe Broker Startup Logs for Artemis Identification**:
    When an AMQ Broker instance starts, the logs will explicitly mention Apache ActiveMQ Artemis. Examine the provided log snippets from a typical AMQ Broker startup. Notice the messages confirming the Artemis server is live and its version.

    
    Server is now live
    2021-09-17 09:35:25,660 INFO  [org.apache.activemq.artemis.core.server] AMQ221001:
     
    Apache ActiveMQ Artemis Message Broker version 2.16.0.redhat-00022 [amq-broker,
     
    nodeID=8d886031-179a-11ec-9e02-0a580ad9008b]
    2021-09-17 09:35:26,470 INFO  [org.apache.amq.hawtio.branding.PluginContextListener]
     
    Initialized amq-broker-redhat-branding plugin
    2021-09-17 09:35:26,656 INFO  [org.apache.activemq.hawtio.plugin.PluginContextListener]
     
    Initialized artemis-plugin plugin
    ...
    AMQ101000: Starting ActiveMQ Artemis Server
    ...
    2020-06-03 12:12:12,336 INFO  [org.apache.activemq.artemis.core.server] AMQ221007:
     
    Server is now live
    

    In this output, observe the key indicators:
    *   The log entry `AMQ221001: Apache ActiveMQ Artemis Message Broker version 2.16.0.redhat-00022` clearly identifies the underlying messaging engine and its specific version. The `.redhat-00022` suffix denotes Red Hat's specific build, indicating it's an enterprise-hardened version.
    *   The `org.apache.activemq.artemis.core.server` log category confirms that the Artemis core components are active and managing the server's lifecycle.
    *   Messages like `AMQ101000: Starting ActiveMQ Artemis Server` and `AMQ221007: Server is now live` are direct lifecycle messages from the Artemis server, confirming its successful startup.

.  **Explore the Artemis Command Line Interface (CLI)**:
    Even within an AMQ Broker installation (especially a local standalone installation for development or testing, or within the container image), you'll often find and interact with the underlying `artemis` command-line utility. This CLI is powerful for administrative tasks, queue management, and more, offering a direct way to interact with the broker's foundational capabilities.

    
    
    $ <broker-instance-dir>/bin/artemis queue create --name exampleQueue --address exampleQueue --auto-create-address --anycast
    

    This command demonstrates using the `artemis` executable, which is part of the core Apache ActiveMQ Artemis distribution. It allows you to directly interact with and manage broker resources like queues and addresses. The `<broker-instance-dir>` typically refers to the root directory where a standalone Artemis (or AMQ Broker) instance has been created or extracted.

    While on OpenShift, these operations are primarily abstracted and managed by the AMQ Broker Operator through Custom Resources, understanding the underlying `artemis` CLI provides invaluable insight into the broker's configuration and management capabilities. It reinforces that the Operator effectively automates actions that, in a standalone environment, you would perform manually using this CLI.

This activity reinforces that Red Hat AMQ Broker is a carefully engineered product built on the solid foundations of Apache ActiveMQ Artemis, making its core concepts essential knowledge for any AMQ Broker administrator or developer.
