<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OpenShift Storage Considerations (Persistent Volumes) :: AMQ Broker on OpenShift: Deployment and Management</title>
    <link rel="prev" href="choosing-the-appropriate-message-store-strategy.html">
    <link rel="next" href="../accessing-management-console-for-amq-broker-on-openshift/accessing-management-console-for-amq-broker-on-openshift.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">AMQ Broker on OpenShift: Deployment and Management</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="amq-on-openshift" data-version="1.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">AMQ Broker on OpenShift: Deployment and Management</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../overview-of-message-oriented-middleware/overview-of-message-oriented-middleware.html">Overview of Message-Oriented Middleware</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/introduction-to-message-oriented-middleware-mom.html">Introduction to Message-Oriented Middleware (MOM)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/benefits-and-use-cases-of-asynchronous-messaging.html">Benefits and Use Cases of Asynchronous Messaging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/core-concepts-producers-consumers-queues-topics.html">Core Concepts: Producers, Consumers, Queues, Topics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/common-messaging-patterns-point-to-point-publishsubscribe.html">Common Messaging Patterns</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../amq-broker-overview/amq-broker-overview.html">AMQ Broker Overview</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/introduction-to-red-hat-amq-broker.html">Introduction to Red Hat AMQ Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/foundations-in-apache-activemq-artemis.html">Foundations in Apache ActiveMQ Artemis</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/key-features-and-capabilities.html">Key Features and Capabilities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/supported-messaging-protocols-jms-amqp-mqtt-stomp-openwire.html">Supported Messaging Protocols (JMS, AMQP, MQTT, STOMP, OpenWire)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/amq-broker-architecture.html">AMQ Broker Architecture</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/deploying-amq-broker-on-openshift.html">Deploying AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/openshift-container-platform-fundamentals-for-amq-broker.html">OpenShift Container Platform Fundamentals for AMQ Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/introduction-to-the-amq-broker-operator.html">Introduction to the AMQ Broker Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/installing-the-amq-broker-operator-via-cli-or-operatorhub.html">Installing the AMQ Broker Operator via CLI or OperatorHub</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/understanding-amq-broker-custom-resource-definitions-crds.html">understanding-amq-broker-custom-resource-definitions-crds.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/creating-and-managing-broker-instances-with-custom-resources-crs.html">Creating and Managing Broker Instances with Custom Resources (CRs)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/monitoring-initial-broker-deployment.html">Monitoring Initial Broker Deployment</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/scaling-amq-broker-on-openshift.html">Scaling AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/concepts-of-horizontal-and-vertical-scaling.html">Concepts of Horizontal and Vertical Scaling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/scaling-broker-pods-and-replicas.html">Scaling Broker Pods and Replicas</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/adjusting-resource-allocations-cpu-memory-for-broker-pods.html">Adjusting Resource Allocations (CPU, Memory) for Broker Pods</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/performance-considerations-for-scaling.html">Performance Considerations for Scaling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/best-practices-for-scaling-in-openshift.html">Best Practices for Scaling AMQ Broker on OpenShift</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../securing-amq-broker-on-openshift/securing-amq-broker-on-openshift.html">Securing AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/encrypting-connections.html">Encrypting Connections</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/configuring-ssltls-for-client-broker-communication.html">Configuring SSL/TLS for Client-Broker Communication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/managing-certificates-and-trust-stores-on-openshift.html">Managing Certificates and Trust Stores on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/enabling-secure-listeners.html">Enabling Secure Listeners</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/enabling-rbac-role-based-access-control.html">Enabling RBAC (Role-Based Access Control)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/defining-users-roles-and-permissions-in-amq-broker.html">Defining Users, Roles, and Permissions in AMQ Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/integrating-with-openshift-authentication-mechanisms.html">Integrating with OpenShift Authentication Mechanisms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/integrating-external-identity-providers-idp.html">Integrating External Identity Providers (IDP)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/overview-of-external-idp-integration-eg-ldap-keycloak.html">Overview of External IDP Integration (e.g., LDAP, Keycloak)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/configuring-amq-broker-for-external-idp-authentication.html">Configuring AMQ Broker for External Identity Provider (IDP) Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/mapping-external-roles-to-broker-roles.html">Mapping External Roles to Broker Roles</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/amq-broker-high-availability-on-openshift.html">AMQ Broker High Availability on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/introduction-to-high-availability-ha-concepts.html">Introduction to High Availability (HA) Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/broker-clustering-strategies-shared-store-vs-replicated-live-backup.html">Broker Clustering Strategies: Shared Store vs. Replicated Live-Backup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/deploying-and-configuring-an-ha-broker-pair.html">Deploying and Configuring an HA Broker Pair</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/understanding-failover-and-recovery-mechanisms.html">Understanding Failover and Recovery Mechanisms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/persistence-and-data-replication-for-ha.html">Persistence and Data Replication for HA</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="different-message-stores-for-amq-broker-on-openshift.html">Different Message Stores for AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="overview-of-message-store-options.html">Overview of Message Store Options</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="file-based-message-store-configuration.html">File-Based Message Store Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jdbc-message-store-integration-with-external-databases.html">JDBC Message Store Integration with External Databases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="journal-vs-paging-for-message-persistence.html">Journal vs. Paging for Message Persistence</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="choosing-the-appropriate-message-store-strategy.html">Choosing the Appropriate Message Store Strategy</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="openshift-storage-considerations-persistent-volumes.html">Storage Considerations</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/accessing-management-console-for-amq-broker-on-openshift.html">Accessing Management Console for AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/introduction-to-the-hawtio-management-console.html">Introduction to the Hawtio Management Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/exposing-the-console-via-openshift-routes.html">Exposing the Hawtio Management Console via OpenShift Routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/authentication-and-authorization-for-console-access.html">Authentication and Authorization for AMQ Broker Management Console Access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/monitoring-broker-metrics-queues-and-topics.html">Monitoring Broker Metrics, Queues, and Topics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/performing-administrative-tasks-through-the-console.html">Performing Administrative Tasks through the Console</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/enabling-external-access-to-brokers-deployed-on-openshift.html">Enabling External Access to Brokers Deployed on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/openshift-networking-concepts-services-routes-ingress.html">OpenShift Networking Concepts: Services, Routes, Ingress</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/exposing-broker-listeners-via-openshift-routes.html">Exposing Broker Listeners via OpenShift Routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/configuring-client-connections-for-external-access.html">Configuring Client Connections for External Access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/security-implications-and-best-practices-for-external-access.html">Securing External Access to AMQ Broker on OpenShift</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../core-protocol-client-examples/core-protocol-client-examples.html">Core Protocol Client Examples</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/introduction-to-amq-core-protocol.html">Introduction to AMQ Core Protocol</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/setting-up-a-core-protocol-client-development-environment.html">Setting Up a Core Protocol Client Development Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/developing-producers-and-consumers-with-java-core-protocol.html">Developing Producers and Consumers with Java Core Protocol</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/implementing-point-to-point-messaging.html">Implementing Point-to-Point Messaging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/implementing-publishsubscribe-messaging.html">Implementing Publish/Subscribe Messaging</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../amqp-protocol-client-examples/amqp-protocol-client-examples.html">AMQP Protocol Client Examples</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/introduction-to-amqp-10-standard.html">Introduction to AMQP 1.0 Standard</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/setting-up-an-amqp-client-development-environment-eg-qpid-jms.html">Setting Up an AMQP Client Development Environment (e.g., Qpid JMS)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/developing-producers-and-consumers-with-amqp-clients-eg-java-python.html">Developing Producers and Consumers with AMQP Clients (e.g., Java, Python)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/connecting-to-amq-broker-using-amqp.html">Connecting to AMQ Broker using AMQP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/exploring-advanced-amqp-features.html">Exploring Advanced AMQP Features</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/hands-on-lab-deploying-and-managing-amq-broker.html">Hands-on Lab: Deploying and Managing AMQ Broker</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-deploying-a-basic-amq-broker-instance.html">Lab: Deploying a Basic AMQ Broker Instance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-configuring-external-access-and-testing-client-connectivity.html">Lab: Configuring External Access and Testing Client Connectivity</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-implementing-basic-security-encryption-rbac.html">Lab: Implementing Basic Security (Encryption, RBAC)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-deploying-an-ha-broker-cluster.html">Lab: Deploying an HA Broker Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-monitoring-with-the-management-console.html">Lab: Monitoring with the Management Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-developing-and-testing-core-protocol-and-amqp-clients.html">Lab: Developing and Testing Core Protocol and AMQP Clients</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">AMQ Broker on OpenShift: Deployment and Management</span>
    <span class="version">1.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">AMQ Broker on OpenShift: Deployment and Management</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">AMQ Broker on OpenShift: Deployment and Management</a></li>
    <li><a href="different-message-stores-for-amq-broker-on-openshift.html">Different Message Stores for AMQ Broker on OpenShift</a></li>
    <li><a href="openshift-storage-considerations-persistent-volumes.html">Storage Considerations</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">OpenShift Storage Considerations (Persistent Volumes)</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This section is crucial for understanding how Red Hat AMQ Broker manages data persistence on OpenShift Container Platform. It covers the fundamentals of storage options, the role of Persistent Volumes (PVs), and best practices for configuring reliable message storage.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_importance_of_persistent_storage_for_amq_broker"><a class="anchor" href="#_the_importance_of_persistent_storage_for_amq_broker"></a>The Importance of Persistent Storage for AMQ Broker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When deploying a message broker like Red Hat AMQ Broker, ensuring the persistence of messages, queues, topic subscriptions, and broker state is paramount. Without durable storage, any data residing within the broker would be lost if a broker pod restarts, crashes, or is rescheduled. This leads to unacceptable data loss and unreliable messaging, which is critical for enterprise integration patterns.</p>
</div>
<div class="paragraph">
<p>OpenShift Container Platform, as a robust container orchestration platform, provides sophisticated mechanisms for managing storage for stateful applications. For AMQ Broker, these mechanisms primarily involve <strong>Persistent Volumes (PVs)</strong> and <strong>Persistent Volume Claims (PVCs)</strong>.</p>
</div>
<div class="sect2">
<h3 id="_ephemeral_vs_persistent_storage"><a class="anchor" href="#_ephemeral_vs_persistent_storage"></a>Ephemeral vs. Persistent Storage</h3>
<div class="paragraph">
<p>The AMQ Broker Operator allows you to configure the type of storage your broker instances use via the <code>persistenceEnabled</code> flag within the broker&#8217;s Custom Resource (CR).</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ephemeral Storage</strong> (<code>persistenceEnabled=false</code>):
When <code>persistenceEnabled</code> is set to <code>false</code>, the deployed brokers utilize <strong>ephemeral storage</strong>. This is transient local storage tied directly to the lifecycle of the broker pod. Consequently, any data (such as message journals or paging files) written to this storage is irrevocably lost every time the broker pod restarts or is deleted. While this might be suitable for certain development, testing, or truly stateless messaging patterns, it is generally <strong>unsuitable for production environments</strong> where message durability and data integrity are non-negotiable.</p>
</li>
<li>
<p><strong>Persistent Storage</strong> (<code>persistenceEnabled=true</code>):
Conversely, setting <code>persistenceEnabled</code> to <code>true</code> instructs the AMQ Broker Operator to provision <strong>persistent storage</strong> for each broker instance. This ensures that the broker&#8217;s critical data, including its journal and other data files, are written to a durable storage volume. With persistent storage, if a broker pod restarts or is rescheduled to a different node, it can seamlessly reattach to its dedicated Persistent Volume, and all its data remains intact. This is the <strong>recommended and default approach for production deployments</strong> to guarantee message durability, enable proper failover, and facilitate recovery.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is highly recommended to deploy AMQ Broker instances with <code>persistenceEnabled=true</code> for any environment beyond basic development and testing to prevent data loss.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_persistent_volumes_pvs_and_persistent_volume_claims_pvcs_explained"><a class="anchor" href="#_persistent_volumes_pvs_and_persistent_volume_claims_pvcs_explained"></a>Persistent Volumes (PVs) and Persistent Volume Claims (PVCs) Explained</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenShift&#8217;s storage model is built upon the abstraction of Persistent Volumes and Persistent Volume Claims:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Persistent Volume (PV)</strong>: A PV represents a piece of storage in the cluster that has been provisioned. It is an abstract storage resource available in the OpenShift cluster, independent of any specific pod. PVs can be provisioned manually by an administrator (static provisioning) or automatically by a Storage Class (dynamic provisioning) from various underlying storage technologies like NFS, iSCSI, CephFS, GlusterFS, cloud provider storage (AWS EBS, Azure Disk, GCE Persistent Disk), and OpenShift Data Foundation.</p>
</li>
<li>
<p><strong>Persistent Volume Claim (PVC)</strong>: A PVC is a request for storage by a user or an application (in our case, by the AMQ Broker Operator). It specifies requirements like storage size, access mode (e.g., ReadWriteOnce), and optionally a Storage Class. The OpenShift control plane then attempts to find an available PV that satisfies the PVC&#8217;s requirements and binds them together.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <code>persistenceEnabled=true</code> is set in your AMQ Broker Custom Resource, the Operator dynamically creates a Persistent Volume Claim (PVC) for each broker instance. This PVC then seeks to bind with an appropriate Persistent Volume (PV) to provide the necessary durable storage.</p>
</div>
<div class="sect2">
<h3 id="_broker_storage_requirements"><a class="anchor" href="#_broker_storage_requirements"></a>Broker Storage Requirements</h3>
<div class="paragraph">
<p>By default, each AMQ Broker instance requires <strong>2 GiB</strong> of storage when configured for persistence (<code>persistenceEnabled=true</code>).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are planning to deploy a cluster of multiple brokers with persistent storage (e.g., a two-broker High Availability cluster), you must ensure that a corresponding number of Persistent Volumes are available â€“ for instance, two PVs each providing 2 GiB of storage for a two-node cluster.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can customize the default storage requirements by specifying the <code>storage</code> parameter within your AMQ Broker Custom Resource definition. The storage size supports standard byte notation such as "K", "MB", and "GB".</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_manual_provisioning_of_persistent_volumes"><a class="anchor" href="#_manual_provisioning_of_persistent_volumes"></a>Manual Provisioning of Persistent Volumes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While many OpenShift clusters are configured with <strong>container-native storage</strong> (e.g., OpenShift Data Foundation, Rook-Ceph) that enables dynamic provisioning of PVs via <a href="#https://docs.openshift.com/container-platform/latest/storage/dynamic-provisioning.html" class="xref unresolved">Storage Classes^</a>, there are scenarios where dynamic provisioning might not be available, or a specific, pre-existing storage infrastructure needs to be used.</p>
</div>
<div class="paragraph">
<p>In such cases, you will need to <strong>manually provision Persistent Volumes (PVs)</strong>. This involves a cluster administrator explicitly creating PV objects in OpenShift, which then become available for PVCs to claim.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When manually provisioning PVs, it is <strong>critically important</strong> to set the <code>persistentVolumeReclaimPolicy</code> for each PV to <code>Retain</code>. If this policy is not set to <code>Retain</code> and the Persistent Volume Claim (PVC) that claimed the PV is deleted (for example, if the AMQ Broker instance itself is deleted), the PV will <strong>also be deleted</strong>, leading to the permanent and irrecoverable loss of all data on that volume.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For comprehensive details on provisioning persistent storage, configuring reclaim policies, and managing storage in OpenShift, refer to the official OpenShift Container Platform documentation on <a href="#https://docs.openshift.com/container-platform/latest/storage/understanding-persistent-storage.html" class="xref unresolved">Understanding persistent storage^</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hands_on_activity_manually_provisioning_an_nfs_persistent_volume"><a class="anchor" href="#_hands_on_activity_manually_provisioning_an_nfs_persistent_volume"></a>Hands-on Activity: Manually Provisioning an NFS Persistent Volume</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This practical activity guides you through the process of manually provisioning an NFS-based Persistent Volume (PV) in OpenShift. This is a common requirement when dynamic storage provisioning is not configured or when specific external storage solutions are used.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This lab requires an accessible NFS server to be configured beforehand. Ensure you are logged into OpenShift as a cluster administrator (<code>system:admin</code>) to perform these steps.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>An active OpenShift cluster where you have cluster-admin privileges.</p>
</li>
<li>
<p>The <code>oc</code> CLI tool installed and configured to connect to your cluster.</p>
</li>
<li>
<p>An operational NFS server with an exported directory (e.g., <code>/nfs/amq-broker-data</code>). Ensure this directory is accessible and writable by your OpenShift nodes.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_procedure"><a class="anchor" href="#_procedure"></a>Procedure</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Log in to OpenShift as a cluster administrator.</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc login -u system:admin</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Create a new project for your AMQ Broker deployment (if you haven&#8217;t already).</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc new-project amq-broker-project</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is recommended to deploy broker instances in separate projects for better isolation and management.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>Switch to your newly created project.</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc project amq-broker-project</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Create a Persistent Volume (PV) definition file.</strong></p>
<div class="paragraph">
<p>Save the following content to a file named <code>amq-broker-pv-1.yaml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: PersistentVolume
metadata:
  name: amq-broker-pv-1
spec:
  capacity:
    storage: 2Gi # Default storage required for one broker instance
  volumeMode: Filesystem
  accessModes:
    - ReadWriteOnce # This access mode allows a volume to be mounted as read-write by a single node.
  persistentVolumeReclaimPolicy: Retain # CRITICAL: Ensures data is not lost if the PVC is deleted.
  nfs:
    path: /nfs/amq-broker-data/broker1 <i class="conum" data-value="1"></i><b>(1)</b>
    server: 192.168.1.100 <i class="conum" data-value="2"></i><b>(2)</b>
  mountOptions:
    - hard
    - nfsvers=4.1 <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Ensure this path exists and is correctly exported on your NFS server for this specific broker&#8217;s data.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Replace <code>192.168.1.100</code> with the actual IP address or hostname of your NFS server.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Specifies NFS mount options for robust connectivity.</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>Apply the PV definition to your OpenShift cluster.</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f amq-broker-pv-1.yaml</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Verify that the Persistent Volume has been created and is in an <code>Available</code> state.</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get pv amq-broker-pv-1</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see output similar to this, indicating the PV is ready to be claimed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">NAME              CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS      CLAIM                  STORAGECLASS   REASON   AGE
amq-broker-pv-1   2Gi        RWO            Retain           Available                                          10s</code></pre>
</div>
</div>
</li>
<li>
<p><strong>(Optional) Prepare for a Multi-Broker Cluster:</strong></p>
<div class="paragraph">
<p>If you plan to deploy multiple AMQ Broker instances (e.g., for an HA cluster), you must create a separate, distinct Persistent Volume for each broker. Repeat steps 4 and 5, adjusting the PV name (e.g., <code>amq-broker-pv-2</code>), the NFS path (e.g., <code>/nfs/amq-broker-data/broker2</code>), and any other relevant parameters in a new YAML file.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This manually provisioned PV is now registered with your OpenShift cluster and is available for the AMQ Broker Operator to claim when you deploy your broker instance with persistent storage enabled (<code>persistenceEnabled=true</code>). The Operator will automatically create a PVC, which will then bind to an available PV matching its requirements.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="choosing-the-appropriate-message-store-strategy.html">Choosing the Appropriate Message Store Strategy</a></span>
  <span class="next"><a href="../accessing-management-console-for-amq-broker-on-openshift/accessing-management-console-for-amq-broker-on-openshift.html">Accessing Management Console for AMQ Broker on OpenShift</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
