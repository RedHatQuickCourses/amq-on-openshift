<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Choosing the Appropriate Message Store Strategy :: AMQ Broker on OpenShift: Deployment and Management</title>
    <link rel="prev" href="journal-vs-paging-for-message-persistence.html">
    <link rel="next" href="openshift-storage-considerations-persistent-volumes.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">AMQ Broker on OpenShift: Deployment and Management</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="amq-on-openshift" data-version="1.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">AMQ Broker on OpenShift: Deployment and Management</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../overview-of-message-oriented-middleware/overview-of-message-oriented-middleware.html">Overview of Message-Oriented Middleware</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/introduction-to-message-oriented-middleware-mom.html">Introduction to Message-Oriented Middleware (MOM)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/benefits-and-use-cases-of-asynchronous-messaging.html">Benefits and Use Cases of Asynchronous Messaging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/core-concepts-producers-consumers-queues-topics.html">Core Concepts: Producers, Consumers, Queues, Topics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/common-messaging-patterns-point-to-point-publishsubscribe.html">Common Messaging Patterns (Point-to-Point, Publish/Subscribe)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../amq-broker-overview/amq-broker-overview.html">AMQ Broker Overview</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/introduction-to-red-hat-amq-broker.html">Introduction to Red Hat AMQ Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/foundations-in-apache-activemq-artemis.html">Foundations in Apache ActiveMQ Artemis</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/key-features-and-capabilities.html">Key Features and Capabilities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/supported-messaging-protocols-jms-amqp-mqtt-stomp-openwire.html">Supported Messaging Protocols (JMS, AMQP, MQTT, STOMP, OpenWire)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/amq-broker-architecture.html">AMQ Broker Architecture</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/deploying-amq-broker-on-openshift.html">Deploying AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/openshift-container-platform-fundamentals-for-amq-broker.html">OpenShift Container Platform Fundamentals for AMQ Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/introduction-to-the-amq-broker-operator.html">Introduction to the AMQ Broker Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/installing-the-amq-broker-operator-via-cli-or-operatorhub.html">Installing the AMQ Broker Operator via CLI or OperatorHub</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/understanding-amq-broker-custom-resource-definitions-crds.html">Understanding AMQ Broker Custom Resource Definitions (CRDs)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/creating-and-managing-broker-instances-with-custom-resources-crs.html">Creating and Managing Broker Instances with Custom Resources (CRs)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/monitoring-initial-broker-deployment.html">Monitoring Initial Broker Deployment</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/scaling-amq-broker-on-openshift.html">Scaling AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/concepts-of-horizontal-and-vertical-scaling.html">Concepts of Horizontal and Vertical Scaling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/scaling-broker-pods-and-replicas.html">Scaling Broker Pods and Replicas</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/adjusting-resource-allocations-cpu-memory-for-broker-pods.html">Adjusting Resource Allocations (CPU, Memory) for Broker Pods</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/performance-considerations-for-scaling.html">Performance Considerations for Scaling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/best-practices-for-scaling-in-openshift.html">Best Practices for Scaling in OpenShift</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../securing-amq-broker-on-openshift/securing-amq-broker-on-openshift.html">Securing AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/encrypting-connections.html">Encrypting Connections</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/configuring-ssltls-for-client-broker-communication.html">Configuring SSL/TLS for Client-Broker Communication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/managing-certificates-and-trust-stores-on-openshift.html">Managing Certificates and Trust Stores on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/enabling-secure-listeners.html">Enabling Secure Listeners</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/enabling-rbac-role-based-access-control.html">Enabling RBAC (Role-Based Access Control)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/defining-users-roles-and-permissions-in-amq-broker.html">Defining Users, Roles, and Permissions in AMQ Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/integrating-with-openshift-authentication-mechanisms.html">Integrating with OpenShift Authentication Mechanisms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/integrating-external-identity-providers-idp.html">Integrating External Identity Providers (IDP)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/overview-of-external-idp-integration-eg-ldap-keycloak.html">Overview of External IDP Integration (e.g., LDAP, Keycloak)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/configuring-amq-broker-for-external-idp-authentication.html">Configuring AMQ Broker for External IDP Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/mapping-external-roles-to-broker-roles.html">Mapping External Roles to Broker Roles</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/amq-broker-high-availability-on-openshift.html">AMQ Broker High Availability on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/introduction-to-high-availability-ha-concepts.html">Introduction to High Availability (HA) Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/broker-clustering-strategies-shared-store-vs-replicated-live-backup.html">Broker Clustering Strategies: Shared Store vs. Replicated Live-Backup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/deploying-and-configuring-an-ha-broker-pair.html">Deploying and Configuring an HA Broker Pair</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/understanding-failover-and-recovery-mechanisms.html">Understanding Failover and Recovery Mechanisms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/persistence-and-data-replication-for-ha.html">Persistence and Data Replication for HA</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="different-message-stores-for-amq-broker-on-openshift.html">Different Message Stores for AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="overview-of-message-store-options.html">Overview of Message Store Options</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="file-based-message-store-configuration.html">File-Based Message Store Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jdbc-message-store-integration-with-external-databases.html">JDBC Message Store Integration with External Databases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="journal-vs-paging-for-message-persistence.html">Journal vs. Paging for Message Persistence</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="choosing-the-appropriate-message-store-strategy.html">Choosing the Appropriate Message Store Strategy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="openshift-storage-considerations-persistent-volumes.html">OpenShift Storage Considerations (Persistent Volumes)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/accessing-management-console-for-amq-broker-on-openshift.html">Accessing Management Console for AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/introduction-to-the-hawtio-management-console.html">Introduction to the Hawtio Management Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/exposing-the-console-via-openshift-routes.html">Exposing the Console via OpenShift Routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/authentication-and-authorization-for-console-access.html">Authentication and Authorization for Console Access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/monitoring-broker-metrics-queues-and-topics.html">Monitoring Broker Metrics, Queues, and Topics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/performing-administrative-tasks-through-the-console.html">Performing Administrative Tasks through the Console</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/enabling-external-access-to-brokers-deployed-on-openshift.html">Enabling External Access to Brokers Deployed on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/openshift-networking-concepts-services-routes-ingress.html">OpenShift Networking Concepts: Services, Routes, Ingress</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/exposing-broker-listeners-via-openshift-routes.html">Exposing Broker Listeners via OpenShift Routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/configuring-client-connections-for-external-access.html">Configuring Client Connections for External Access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/security-implications-and-best-practices-for-external-access.html">Security Implications and Best Practices for External Access</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../core-protocol-client-examples/core-protocol-client-examples.html">Core Protocol Client Examples</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/introduction-to-amq-core-protocol.html">Introduction to AMQ Core Protocol</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/setting-up-a-core-protocol-client-development-environment.html">Setting Up a Core Protocol Client Development Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/developing-producers-and-consumers-with-java-core-protocol.html">Developing Producers and Consumers with Java Core Protocol</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/implementing-point-to-point-messaging.html">Implementing Point-to-Point Messaging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/implementing-publishsubscribe-messaging.html">Implementing Publish/Subscribe Messaging</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../amqp-protocol-client-examples/amqp-protocol-client-examples.html">AMQP Protocol Client Examples</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/introduction-to-amqp-10-standard.html">Introduction to AMQP 1.0 Standard</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/setting-up-an-amqp-client-development-environment-eg-qpid-jms.html">Setting Up an AMQP Client Development Environment (e.g., Qpid JMS)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/developing-producers-and-consumers-with-amqp-clients-eg-java-python.html">Developing Producers and Consumers with AMQP Clients (e.g., Java, Python)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/connecting-to-amq-broker-using-amqp.html">Connecting to AMQ Broker using AMQP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/exploring-advanced-amqp-features.html">Exploring Advanced AMQP Features</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/hands-on-lab-deploying-and-managing-amq-broker.html">Hands-on Lab: Deploying and Managing AMQ Broker</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-deploying-a-basic-amq-broker-instance.html">Lab: Deploying a Basic AMQ Broker Instance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-configuring-external-access-and-testing-client-connectivity.html">Lab: Configuring External Access and Testing Client Connectivity</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-implementing-basic-security-encryption-rbac.html">Lab: Implementing Basic Security (Encryption, RBAC)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-deploying-an-ha-broker-cluster.html">Lab: Deploying an HA Broker Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-monitoring-with-the-management-console.html">Lab: Monitoring with the Management Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-developing-and-testing-core-protocol-and-amqp-clients.html">Lab: Developing and Testing Core Protocol and AMQP Clients</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">AMQ Broker on OpenShift: Deployment and Management</span>
    <span class="version">1.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">AMQ Broker on OpenShift: Deployment and Management</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">AMQ Broker on OpenShift: Deployment and Management</a></li>
    <li><a href="different-message-stores-for-amq-broker-on-openshift.html">Different Message Stores for AMQ Broker on OpenShift</a></li>
    <li><a href="choosing-the-appropriate-message-store-strategy.html">Choosing the Appropriate Message Store Strategy</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Choosing the Appropriate Message Store Strategy</h1>
<div class="paragraph">
<p>This document covers the objectives related to choosing an appropriate message store strategy for AMQ Broker deployments on OpenShift. It explains the available options, their characteristics, and the factors to consider for making an informed decision.</p>
</div>
<div class="paragraph">
<p><em>This content is provided in Antora AsciiDoc format.</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">[[amq-broker-message-store-strategy]]
= Choosing the Appropriate Message Store Strategy

Understanding and selecting the correct message store strategy is a critical decision for any AMQ Broker deployment, especially in containerized environments like OpenShift. The choice impacts performance, reliability, scalability, and operational complexity. This section details the primary message store options available for AMQ Broker and provides guidance on how to choose the best strategy for your specific use case.

[[amq-broker-message-store-overview]]
== Overview of Message Store Options

AMQ Broker, based on Apache ActiveMQ Artemis, primarily offers two fundamental approaches for message persistence:

*   xref:file-based-message-store.adoc[File-Based Journal]
*   xref:jdbc-message-store.adoc[JDBC Message Store]

Each approach has distinct characteristics, advantages, and trade-offs that are important to consider.

[[amq-broker-file-based-journal]]
=== File-Based Journal Store

The file-based journal is the default and generally recommended message store for AMQ Broker due to its high performance and efficiency.

==== Detailed Technical Explanation

The file-based journal stores messages and binding data directly on the filesystem in a highly optimized binary log format. It uses a write-ahead log (WAL) approach, ensuring that data is written to disk before an acknowledgment is sent back to the producer. This design provides excellent durability while minimizing I/O overhead.

Key characteristics:

*   *Performance:* The file-based journal is designed for maximum throughput and minimal latency. It uses sequential writes, which are significantly faster than random writes, making it ideal for high-volume messaging scenarios.
*   *Simplicity:* It's the default configuration, requiring no external database setup.
*   *Data Structure:* Data is stored in a series of journal files (e.g., `activemq-data-*.amq`) within a configured directory.
*   *OpenShift Considerations:* When deploying on OpenShift, the file-based journal requires persistent storage, typically provisioned via Persistent Volumes (PVs). For single instances or replicated high-availability (HA) setups, a `ReadWriteOnce` (RWO) PV is sufficient. For shared-store HA, a `ReadWriteMany` (RWX) PV is required, allowing multiple broker pods to access the same underlying storage.

[[amq-broker-jdbc-message-store]]
=== JDBC Message Store

The JDBC message store allows AMQ Broker to persist messages and bindings to an external relational database using Java Database Connectivity (JDBC).

==== Detailed Technical Explanation

Instead of writing to local journal files, the broker interacts with a database through a JDBC driver. Message and binding data are stored in database tables, encoded using the AMQ Broker journal encoding. This approach leverages the durability and transactional capabilities of the underlying database.

Key characteristics:

*   *Integration:* It allows integration with existing database infrastructure and operational practices, which can be advantageous in environments with strict data management policies or existing database teams.
*   *Manageability:* Database tools can be used for backup, recovery, and monitoring of the message store data, fitting into established enterprise IT strategies.
*   *Performance Overhead:* As highlighted in the context, "use of a database can negatively effect the performance of a messaging system. Specifically, writing messaging data to database tables via JDBC creates a significant performance overhead for a broker." This is due to the additional latency of network communication with the database, the overhead of SQL queries, and the transactional nature of database operations compared to the highly optimized sequential writes of the file-based journal.
*   *Supported Databases:* AMQ Broker supports various relational databases. For a definitive list, refer to the xref:amq-broker-supported-configurations.adoc[Red Hat AMQ 7 Supported Configurations] on the Red Hat Customer Portal.
*   *OpenShift Considerations:*
    *   *External Database:* Requires an external database instance (e.g., PostgreSQL, MySQL, Oracle, MS SQL Server) accessible from the OpenShift cluster.
    *   *JDBC Driver:* The necessary JDBC driver JAR file must be made available to the broker at runtime. This typically involves using a custom image or mounting the JAR file into the broker pod. Refer to xref:add-third-party-jars.adoc[Section 4.4, “Adding third-party JAR files”] in the AMQ Broker documentation for details.
    *   *Secrets:* Database credentials (username, password) should be managed securely using OpenShift Secrets.

[[amq-broker-journal-vs-paging]]
=== Journal vs. Paging for Message Persistence

While not a primary "store strategy" in the same vein as file-based vs. JDBC, the concepts of "journal" and "paging" are critical to understanding AMQ Broker's message persistence.

*   *Journal:* As discussed, the journal is the primary persistence mechanism for active, in-flight messages and binding data. It ensures durability for messages that are intended to be stored.
*   *Paging:* Paging is a flow control mechanism that the broker uses to prevent memory exhaustion when a queue accumulates a large number of messages, or when consumers are slow. Instead of keeping all messages in memory, the broker "pages" them out to disk (using dedicated paging files on the filesystem, regardless of whether the main message store is file-based or JDBC). When consumers become available, messages are paged back into memory. Paging is always filesystem-based and is distinct from the primary message store for durability.

[[amq-broker-choosing-strategy-factors]]
== Choosing the Appropriate Message Store Strategy

The decision between a file-based journal and a JDBC message store depends on several factors:

.Comparison of Message Store Strategies
|===
| Feature | File-Based Journal | JDBC Message Store

| *Performance* | link: #amq-broker-file-based-journal[Excellent] (high throughput, low latency) | link: #amq-broker-jdbc-message-store[Lower] (significant overhead compared to file-based)
| *Simplicity* | High (default, no external database needed) | Moderate (requires external database, JDBC driver, configuration)
| *Integration* | Less integrated with existing database infrastructure | Highly integrated with existing database infrastructure
| *Data Management* | Specialized tools/scripts for journal management; relies on PV snapshots for backup | Standard database tools for backup, recovery, monitoring
| *High Availability (HA)* |
** Shared Store: Requires `ReadWriteMany` (RWX) PV.
** Replicated Live-Backup: `ReadWriteOnce` (RWO) PV per broker.
|
** Shared Store: Requires an external database accessible by all broker instances.
** Replicated Live-Backup: Each broker instance *can* use the same external database, but typically replicated HA uses its own internal persistence.
| *OpenShift Storage* | Persistent Volumes (RWO or RWX) | External database service
|===

Based on these factors, consider the following:

*   *Prioritize Performance:* If your primary concern is maximum message throughput and lowest latency, the *file-based journal* is almost always the superior choice. This is the recommended default for most high-performance messaging applications.
*   *Leverage Existing IT Infrastructure:* If your organization has strong existing database infrastructure, established operational procedures for database management (backup, monitoring, security), and a preference for centralizing data, then a *JDBC message store* might be a good fit, *provided you can accept the performance trade-offs*.
*   *High Availability Requirements:*
    *   For *shared-store HA*, both strategies are viable. The file-based approach requires an RWX Persistent Volume, while the JDBC approach requires a shared database.
    *   For *replicated live-backup HA*, each live broker in a replication pair has its own persistence. File-based is generally simpler as it only requires RWO PVs. If using JDBC with replicated HA, ensure your database can handle the load from multiple brokers and that replication is configured correctly.
*   *Operational Complexity:* While JDBC can simplify data management by leveraging existing database tools, it adds complexity in terms of managing the external database, its network connectivity, and JDBC driver availability within your OpenShift deployment.

In general, for new deployments on OpenShift, especially those focused on cloud-native patterns and high performance, the *file-based journal with OpenShift Persistent Volumes* is often the most straightforward and performant choice.

[[amq-broker-hands-on-message-store-prep]]
== Hands-on Activity: Preparing for Message Store Configuration

This activity focuses on understanding how message store options are specified within the `ActiveMQArtemis` Custom Resource (CR) on OpenShift, and the prerequisites for each.

=== Objective

*   Review the structure of an `ActiveMQArtemis` CR to locate message store configuration options.
*   Identify the key parameters for configuring a file-based journal versus a JDBC message store.
*   Understand the prerequisites for a JDBC message store deployment.

=== Steps

.  **Log in to OpenShift:**
   Ensure you are logged into your OpenShift cluster using the `oc` CLI.

   ```bash
   oc login -u &lt;your_username&gt; -p &lt;your_password&gt; &lt;your_openshift_cluster_url&gt;
   ```

.  **Identify Message Store Configuration in a Sample CR:**
   Examine a sample `ActiveMQArtemis` Custom Resource (CR). If you have an AMQ Broker Operator installed, you can get a sample or create a basic one.

   Let's look at a conceptual `ActiveMQArtemis` CR snippet for a file-based store:

   ```yaml
   apiVersion: broker.amq.io/v1beta1
   kind: ActiveMQArtemis
   metadata:
     name: my-broker
   spec:
     deploymentPlan:
       size: 1
       image: registry.redhat.io/amq7/amq-broker-rhel8:7.12
       persistenceEnabled: true
       journalType: large_messages_optimized
       # For file-based persistence, a Persistent Volume Claim (PVC) is automatically created
       # or you can specify an existing one via `storage.pvc` field if not using default.
       # The 'journalType' field indicates the type of journal.
       # Common options:
       #   'large_messages_optimized': Optimized for large messages (default for new CRs)
       #   'nondurable_dlr': Non-durable store for delivery acknowledgements
       #   'nio': Basic Non-Blocking I/O
       #   'aio': Asynchronous I/O (Linux only, requires libaio)
     # ... other configurations
   ```

   Now, consider a conceptual `ActiveMQArtemis` CR snippet for a JDBC message store:

   ```yaml
   apiVersion: broker.amq.io/v1beta1
   kind: ActiveMQArtemis
   metadata:
     name: jdbc-broker
   spec:
     deploymentPlan:
       size: 1
       image: registry.redhat.io/amq7/amq-broker-rhel8:7.12
       persistenceEnabled: true
       # For JDBC, the journalType is implicitly handled by the 'database' configuration
       # or explicitly set to 'jdbc'.
       database:
         type: postgres
         jdbcUrl: "jdbc:postgresql://postgresql-service:5432/brokerdb"
         # Reference to a Secret containing database credentials
         databaseSecret:
           name: broker-db-secret
           userKey: database-user
           passwordKey: database-password
         # Optionally, specify a custom JDBC driver image if not included in the base image
         # jdbcDriverImage: my-custom-jdbc-driver-image:latest
         # Or, configure additional mounts for JDBC driver JARs
         externalVolumes:
           - name: jdbc-driver-volume
             mountPath: /opt/amq/drivers
             secret:
               secretName: custom-jdbc-driver-secret
     # ... other configurations
   ```

.  **Observe Key Differences:**
   *   For file-based persistence, the `persistenceEnabled: true` and `journalType` fields are primary. The OpenShift Operator handles PVC creation and mounting.
   *   For JDBC persistence, the `database` section is introduced. This section specifies:
        *   `type`: The database type (e.g., `postgres`, `mysql`).
        *   `jdbcUrl`: The connection string for your database.
        *   `databaseSecret`: A reference to an OpenShift `Secret` containing the database username and password. This is crucial for securely managing credentials.
        *   `jdbcDriverImage` or `externalVolumes`: How the JDBC driver JAR file is made available to the broker pod. This is a critical prerequisite.

.  **Consider Prerequisites for JDBC:**
   Before deploying an AMQ Broker with a JDBC message store, ensure the following are in place:
   *   **Dedicated Database:** A running database instance (e.g., PostgreSQL, MySQL) accessible from your OpenShift cluster.
   *   **Database Schema/User:** A database and a user with appropriate permissions to create tables and perform read/write operations within that database.
   *   **OpenShift Secret:** An OpenShift `Secret` containing the database username and password.
     ```bash
     oc create secret generic broker-db-secret \
       --from-literal=database-user=mybrokeruser \
       --from-literal=database-password=mybrokerpassword
     ```
   *   **JDBC Driver:** The correct JDBC driver JAR file must be present in the broker's classpath. This can be achieved by:
        *   Using a custom AMQ Broker image that includes the driver.
        *   Mounting the driver JAR from an `ConfigMap` or `Secret` using `externalVolumes` and ensuring it's in the correct path for the broker to pick it up.

This hands-on exploration should solidify your understanding of how to configure and prepare for different message store strategies within an OpenShift AMQ Broker deployment.</code></pre>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="journal-vs-paging-for-message-persistence.html">Journal vs. Paging for Message Persistence</a></span>
  <span class="next"><a href="openshift-storage-considerations-persistent-volumes.html">OpenShift Storage Considerations (Persistent Volumes)</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
