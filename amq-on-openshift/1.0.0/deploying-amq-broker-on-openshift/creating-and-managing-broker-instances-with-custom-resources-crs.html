<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Creating and Managing Broker Instances with Custom Resources (CRs) :: AMQ Broker on OpenShift: Deployment and Management</title>
    <link rel="prev" href="understanding-amq-broker-custom-resource-definitions-crds.html">
    <link rel="next" href="monitoring-initial-broker-deployment.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">AMQ Broker on OpenShift: Deployment and Management</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="amq-on-openshift" data-version="1.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">AMQ Broker on OpenShift: Deployment and Management</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../overview-of-message-oriented-middleware/overview-of-message-oriented-middleware.html">Overview of Message-Oriented Middleware</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/introduction-to-message-oriented-middleware-mom.html">Introduction to Message-Oriented Middleware (MOM)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/benefits-and-use-cases-of-asynchronous-messaging.html">Benefits and Use Cases of Asynchronous Messaging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/core-concepts-producers-consumers-queues-topics.html">Core Concepts: Producers, Consumers, Queues, Topics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/common-messaging-patterns-point-to-point-publishsubscribe.html">Common Messaging Patterns</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../amq-broker-overview/amq-broker-overview.html">AMQ Broker Overview</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/introduction-to-red-hat-amq-broker.html">Introduction to Red Hat AMQ Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/foundations-in-apache-activemq-artemis.html">Foundations in Apache ActiveMQ Artemis</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/key-features-and-capabilities.html">Key Features and Capabilities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/supported-messaging-protocols-jms-amqp-mqtt-stomp-openwire.html">Supported Messaging Protocols (JMS, AMQP, MQTT, STOMP, OpenWire)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/amq-broker-architecture.html">AMQ Broker Architecture</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="deploying-amq-broker-on-openshift.html">Deploying AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="openshift-container-platform-fundamentals-for-amq-broker.html">OpenShift Container Platform Fundamentals for AMQ Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="introduction-to-the-amq-broker-operator.html">Introduction to the AMQ Broker Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="installing-the-amq-broker-operator-via-cli-or-operatorhub.html">Installing the AMQ Broker Operator via CLI or OperatorHub</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="understanding-amq-broker-custom-resource-definitions-crds.html">understanding-amq-broker-custom-resource-definitions-crds.adoc</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="creating-and-managing-broker-instances-with-custom-resources-crs.html">Creating and Managing Broker Instances with Custom Resources (CRs)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="monitoring-initial-broker-deployment.html">Monitoring Initial Broker Deployment</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/scaling-amq-broker-on-openshift.html">Scaling AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/concepts-of-horizontal-and-vertical-scaling.html">Concepts of Horizontal and Vertical Scaling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/scaling-broker-pods-and-replicas.html">Scaling Broker Pods and Replicas</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/adjusting-resource-allocations-cpu-memory-for-broker-pods.html">Adjusting Resource Allocations (CPU, Memory) for Broker Pods</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/performance-considerations-for-scaling.html">Performance Considerations for Scaling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/best-practices-for-scaling-in-openshift.html">Best Practices for Scaling AMQ Broker on OpenShift</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../securing-amq-broker-on-openshift/securing-amq-broker-on-openshift.html">Securing AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/encrypting-connections.html">Encrypting Connections</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/configuring-ssltls-for-client-broker-communication.html">Configuring SSL/TLS for Client-Broker Communication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/managing-certificates-and-trust-stores-on-openshift.html">Managing Certificates and Trust Stores on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/enabling-secure-listeners.html">Enabling Secure Listeners</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/enabling-rbac-role-based-access-control.html">Enabling RBAC (Role-Based Access Control)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/defining-users-roles-and-permissions-in-amq-broker.html">Defining Users, Roles, and Permissions in AMQ Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/integrating-with-openshift-authentication-mechanisms.html">Integrating with OpenShift Authentication Mechanisms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/integrating-external-identity-providers-idp.html">Integrating External Identity Providers (IDP)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/overview-of-external-idp-integration-eg-ldap-keycloak.html">Overview of External IDP Integration (e.g., LDAP, Keycloak)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/configuring-amq-broker-for-external-idp-authentication.html">Configuring AMQ Broker for External Identity Provider (IDP) Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/mapping-external-roles-to-broker-roles.html">Mapping External Roles to Broker Roles</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/amq-broker-high-availability-on-openshift.html">AMQ Broker High Availability on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/introduction-to-high-availability-ha-concepts.html">Introduction to High Availability (HA) Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/broker-clustering-strategies-shared-store-vs-replicated-live-backup.html">Broker Clustering Strategies: Shared Store vs. Replicated Live-Backup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/deploying-and-configuring-an-ha-broker-pair.html">Deploying and Configuring an HA Broker Pair</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/understanding-failover-and-recovery-mechanisms.html">Understanding Failover and Recovery Mechanisms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/persistence-and-data-replication-for-ha.html">Persistence and Data Replication for HA</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../different-message-stores-for-amq-broker-on-openshift/different-message-stores-for-amq-broker-on-openshift.html">Different Message Stores for AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../different-message-stores-for-amq-broker-on-openshift/overview-of-message-store-options.html">Overview of Message Store Options</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../different-message-stores-for-amq-broker-on-openshift/file-based-message-store-configuration.html">File-Based Message Store Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../different-message-stores-for-amq-broker-on-openshift/jdbc-message-store-integration-with-external-databases.html">JDBC Message Store Integration with External Databases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../different-message-stores-for-amq-broker-on-openshift/journal-vs-paging-for-message-persistence.html">Journal vs. Paging for Message Persistence</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../different-message-stores-for-amq-broker-on-openshift/choosing-the-appropriate-message-store-strategy.html">Choosing the Appropriate Message Store Strategy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../different-message-stores-for-amq-broker-on-openshift/openshift-storage-considerations-persistent-volumes.html">Storage Considerations</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/accessing-management-console-for-amq-broker-on-openshift.html">Accessing Management Console for AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/introduction-to-the-hawtio-management-console.html">Introduction to the Hawtio Management Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/exposing-the-console-via-openshift-routes.html">Exposing the Hawtio Management Console via OpenShift Routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/authentication-and-authorization-for-console-access.html">Authentication and Authorization for AMQ Broker Management Console Access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/monitoring-broker-metrics-queues-and-topics.html">Monitoring Broker Metrics, Queues, and Topics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/performing-administrative-tasks-through-the-console.html">Performing Administrative Tasks through the Console</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/enabling-external-access-to-brokers-deployed-on-openshift.html">Enabling External Access to Brokers Deployed on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/openshift-networking-concepts-services-routes-ingress.html">OpenShift Networking Concepts: Services, Routes, Ingress</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/exposing-broker-listeners-via-openshift-routes.html">Exposing Broker Listeners via OpenShift Routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/configuring-client-connections-for-external-access.html">Configuring Client Connections for External Access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/security-implications-and-best-practices-for-external-access.html">Securing External Access to AMQ Broker on OpenShift</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../core-protocol-client-examples/core-protocol-client-examples.html">Core Protocol Client Examples</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/introduction-to-amq-core-protocol.html">Introduction to AMQ Core Protocol</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/setting-up-a-core-protocol-client-development-environment.html">Setting Up a Core Protocol Client Development Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/developing-producers-and-consumers-with-java-core-protocol.html">Developing Producers and Consumers with Java Core Protocol</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/implementing-point-to-point-messaging.html">Implementing Point-to-Point Messaging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/implementing-publishsubscribe-messaging.html">Implementing Publish/Subscribe Messaging</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../amqp-protocol-client-examples/amqp-protocol-client-examples.html">AMQP Protocol Client Examples</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/introduction-to-amqp-10-standard.html">Introduction to AMQP 1.0 Standard</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/setting-up-an-amqp-client-development-environment-eg-qpid-jms.html">Setting Up an AMQP Client Development Environment (e.g., Qpid JMS)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/developing-producers-and-consumers-with-amqp-clients-eg-java-python.html">Developing Producers and Consumers with AMQP Clients (e.g., Java, Python)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/connecting-to-amq-broker-using-amqp.html">Connecting to AMQ Broker using AMQP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/exploring-advanced-amqp-features.html">Exploring Advanced AMQP Features</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/hands-on-lab-deploying-and-managing-amq-broker.html">Hands-on Lab: Deploying and Managing AMQ Broker</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-deploying-a-basic-amq-broker-instance.html">Lab: Deploying a Basic AMQ Broker Instance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-configuring-external-access-and-testing-client-connectivity.html">Lab: Configuring External Access and Testing Client Connectivity</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-implementing-basic-security-encryption-rbac.html">Lab: Implementing Basic Security (Encryption, RBAC)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-deploying-an-ha-broker-cluster.html">Lab: Deploying an HA Broker Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-monitoring-with-the-management-console.html">Lab: Monitoring with the Management Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-developing-and-testing-core-protocol-and-amqp-clients.html">Lab: Developing and Testing Core Protocol and AMQP Clients</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">AMQ Broker on OpenShift: Deployment and Management</span>
    <span class="version">1.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">AMQ Broker on OpenShift: Deployment and Management</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">AMQ Broker on OpenShift: Deployment and Management</a></li>
    <li><a href="deploying-amq-broker-on-openshift.html">Deploying AMQ Broker on OpenShift</a></li>
    <li><a href="creating-and-managing-broker-instances-with-custom-resources-crs.html">Creating and Managing Broker Instances with Custom Resources (CRs)</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Creating and Managing Broker Instances with Custom Resources (CRs)</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This content outlines the process of creating and managing Red Hat AMQ Broker instances on OpenShift using Custom Resources (CRs). It is designed to be technically accurate, engaging, and includes hands-on activities to reinforce learning.</p>
</div>
</div>
</div>
<h1 id="creating-and-managing-broker-instances-with-crs" class="sect0"><a class="anchor" href="#creating-and-managing-broker-instances-with-crs"></a>Creating and Managing Broker Instances with Custom Resources (CRs)</h1>
<div class="paragraph">
<p>This section delves into the fundamental process of deploying and managing AMQ Broker instances on OpenShift using Custom Resources (CRs) provided by the AMQ Broker Operator. Custom Resources extend the Kubernetes API, allowing users to define and manage applications, like AMQ Broker, as native Kubernetes objects.</p>
</div>
<div class="sect1">
<h2 id="_introduction_to_amq_broker_custom_resources"><a class="anchor" href="#_introduction_to_amq_broker_custom_resources"></a>Introduction to AMQ Broker Custom Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the OpenShift Container Platform, the AMQ Broker Operator simplifies the deployment and management of AMQ Broker instances. The Operator achieves this by introducing Custom Resource Definitions (CRDs) which define the schema for various AMQ Broker components.</p>
</div>
<div class="paragraph">
<p>For AMQ Broker, the primary CRDs you&#8217;ll interact with are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ActiveMQArtemis</code>: Used to define and configure the AMQ Broker instance itself, including its size, image, persistence settings, and other deployment-related parameters.</p>
</li>
<li>
<p><code>ActiveMQArtemisAddress</code>: Used to define messaging addresses and queues <strong>on</strong> a deployed broker instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By creating instances of these Custom Resources (CRs), you instruct the AMQ Broker Operator to provision, configure, and manage the underlying broker infrastructure according to your specifications. This declarative approach simplifies complex deployments and day-to-day operations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you begin creating broker instances, ensure you have the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>AMQ Broker Operator Installed:</strong> The AMQ Broker Operator must be installed in your OpenShift cluster. You can install it either using the OpenShift CLI or through the OperatorHub in the OpenShift console. Refer to "Installing the AMQ Broker Operator via CLI or OperatorHub" for detailed instructions.</p>
</li>
<li>
<p><strong>OpenShift Project:</strong> An existing OpenShift project (namespace) where you have the necessary permissions to deploy Custom Resources.</p>
</li>
<li>
<p><strong>OpenShift CLI (<code>oc</code>) or Web Console Access:</strong> Access to the OpenShift command-line interface or the OpenShift web console.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_basic_amq_broker_instance"><a class="anchor" href="#_creating_a_basic_amq_broker_instance"></a>Creating a Basic AMQ Broker Instance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>ActiveMQArtemis</code> Custom Resource is the primary way to deploy and configure an AMQ Broker instance. For a basic deployment, we&#8217;ll configure a single broker without clustering or persistence initially.</p>
</div>
<div class="sect2">
<h3 id="_technical_explanation_activemqartemis_cr_structure"><a class="anchor" href="#_technical_explanation_activemqartemis_cr_structure"></a>Technical Explanation: <code>ActiveMQArtemis</code> CR Structure</h3>
<div class="paragraph">
<p>When creating an <code>ActiveMQArtemis</code> CR, you&#8217;ll define various properties within its YAML structure. Key sections include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>apiVersion</code>: Specifies the API version of the Custom Resource (e.g., <code>broker.amq.io/v1beta1</code>).</p>
</li>
<li>
<p><code>kind</code>: Identifies the type of Custom Resource (e.g., <code>ActiveMQArtemis</code>).</p>
</li>
<li>
<p><code>metadata</code>: Contains metadata about the CR, such as its unique <code>name</code>. The <code>name</code> you provide here will be used by OpenShift to identify your broker deployment.</p>
</li>
<li>
<p><code>spec</code>: This is where the core configuration for your broker instance resides. Within <code>spec</code>, the <code>deploymentPlan</code> sub-section is crucial:</p>
</li>
<li>
<p><code>size</code>: Defines the number of broker pods to deploy. For a basic, single instance, this will be <code>1</code>.</p>
</li>
<li>
<p><code>image</code>: Specifies the container image to use for the broker. It&#8217;s recommended to use Red Hat provided images, like <code>registry.redhat.io/amq7/amq-broker-rhel8:7.13</code>.</p>
</li>
<li>
<p><code>persistenceEnabled</code>: A boolean flag indicating whether the broker should use persistent storage for messages. For a basic, non-persistent setup, this is set to <code>false</code>.</p>
</li>
<li>
<p><code>clustered</code>: A boolean flag indicating whether the broker is part of a cluster. For a single instance, this is set to <code>false</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#https://access.redhat.com/documentation/en-us/red_hat_amq_broker/7.13/html/deploying_amq_broker_on_openshift/deploying-a-single-broker-instance">Section 3.3.1, “Deploying a single broker instance”</a> provides more foundational details.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hands_on_activity_deploy_a_single_amq_broker_instance"><a class="anchor" href="#_hands_on_activity_deploy_a_single_amq_broker_instance"></a>Hands-on Activity: Deploy a Single AMQ Broker Instance</h3>
<div class="paragraph">
<p>In this activity, you will deploy a basic, single AMQ Broker instance named <code>my-broker</code> using a Custom Resource.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure to Deploy a Basic Broker</div>
<ol class="arabic">
<li>
<p><strong>Log in to OpenShift:</strong>
Ensure you are logged into your OpenShift cluster via the <code>oc</code> CLI or the web console, and that you are in the correct project (namespace) where you intend to deploy the broker.</p>
<div class="literalblock">
<div class="content">
<pre>[source,bash,subs="attributes+"]
----
oc login --token=&lt;your_token&gt; --server=&lt;your_api_url&gt;
oc project &lt;your_project_name&gt;
----</pre>
</div>
</div>
</li>
<li>
<p><strong>Create the <code>ActiveMQArtemis</code> Custom Resource YAML:</strong>
Create a file named <code>broker-basic-instance.yaml</code> with the following content. This CR defines a single, non-clustered, non-persistent broker instance.</p>
<div class="literalblock">
<div class="content">
<pre>[source,yaml,subs="attributes+"]
----
apiVersion: broker.amq.io/v1beta1
kind: ActiveMQArtemis
metadata:
  name: my-broker
spec:
  deploymentPlan:
    size: 1
    image: registry.redhat.io/amq7/amq-broker-rhel8:7.13
    persistenceEnabled: false
    clustered: false
----</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>NOTE: The `name` in `metadata` must be unique within your OpenShift project for `ActiveMQArtemis` resources.</pre>
</div>
</div>
</li>
<li>
<p><strong>Apply the Custom Resource:</strong>
Use the <code>oc apply</code> command to deploy the broker instance based on your YAML file.</p>
<div class="literalblock">
<div class="content">
<pre>[source,bash,subs="attributes+"]
----
oc apply -f broker-basic-instance.yaml
----</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>You should see output similar to:
`activemqartemis.broker.amq.io/my-broker created`</pre>
</div>
</div>
</li>
<li>
<p><strong>Verify the Broker Deployment:</strong>
Check the status of your AMQ Broker instance and its associated pods. The Operator will create a deployment and a pod for your broker.</p>
<div class="literalblock">
<div class="content">
<pre>[source,bash,subs="attributes+"]
----
oc get activemqartemis
oc get pods -l app=my-broker
----</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>    Wait until the broker pod shows a `STATUS` of `Running` and `READY` is `1/1`. This indicates the broker is successfully deployed and running.
// end::hands-on-create-basic-broker[]
// end::create-basic-broker[]</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_managing_broker_instances_by_modifying_crs"><a class="anchor" href="#_managing_broker_instances_by_modifying_crs"></a>Managing Broker Instances by Modifying CRs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once a broker instance is deployed, you can manage and update its configuration by modifying the <code>ActiveMQArtemis</code> Custom Resource. The AMQ Broker Operator continuously monitors CRs and applies any changes you make.</p>
</div>
<div class="sect2">
<h3 id="_technical_explanation_modifying_existing_activemqartemis_crs"><a class="anchor" href="#_technical_explanation_modifying_existing_activemqartemis_crs"></a>Technical Explanation: Modifying Existing <code>ActiveMQArtemis</code> CRs</h3>
<div class="paragraph">
<p>To modify a broker, you typically retrieve its existing CR configuration, make the desired changes, and then re-apply it. The <code>spec.deploymentPlan</code> section is frequently updated for scaling, image changes, or enabling/disabling features.</p>
</div>
<div class="paragraph">
<p>Other sections, like <code>spec.brokerProperties</code> (referenced in <a href="#https://access.redhat.com/documentation/en-us/red_hat_amq_broker/7.13/html/deploying_amq_broker_on_openshift/configuring-items-not-exposed-in-a-crd">Section 2.4, “Configuring items not exposed in a custom resource definition (CRD)”</a>), allow for more advanced, direct broker configuration.</p>
</div>
<div class="paragraph">
<p>For example, to enable the Jolokia Agent (for JMX over HTTP access) and Management RBAC, you would add <code>jolokiaAgentEnabled: true</code> and <code>managementRBACEnabled: true</code> under <code>spec.deploymentPlan</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hands_on_activity_enable_jolokia_agent_and_management_rbac"><a class="anchor" href="#_hands_on_activity_enable_jolokia_agent_and_management_rbac"></a>Hands-on Activity: Enable Jolokia Agent and Management RBAC</h3>
<div class="paragraph">
<p>In this activity, you will modify the <code>my-broker</code> instance to enable its Jolokia Agent and management RBAC for enhanced monitoring and security.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure to Modify a Broker Instance</div>
<ol class="arabic">
<li>
<p><strong>Edit the <code>ActiveMQArtemis</code> CR:</strong>
Open the <code>broker-basic-instance.yaml</code> file you created earlier or use <code>oc edit</code> to directly modify the CR on the cluster.</p>
<div class="literalblock">
<div class="content">
<pre>[source,bash,subs="attributes+"]
----
oc edit activemqartemis my-broker
----</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Add the `jolokiaAgentEnabled` and `managementRBACEnabled` properties within the `deploymentPlan` section, as shown below:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>[source,yaml,subs="attributes+"]
----
apiVersion: broker.amq.io/v1beta1
kind: ActiveMQArtemis
metadata:
  name: my-broker
spec:
  deploymentPlan:
    size: 1
    image: registry.redhat.io/amq7/amq-broker-rhel8:7.13
    persistenceEnabled: false
    clustered: false
    jolokiaAgentEnabled: true  <i class="conum" data-value="1"></i><b>(1)</b>
    managementRBACEnabled: true <i class="conum" data-value="2"></i><b>(2)</b>
----
&lt;1&gt; Enables the Jolokia agent for JMX access.
&lt;2&gt; Enables Role-Based Access Control for the management interface.</pre>
</div>
</div>
</li>
<li>
<p><strong>Save and Apply Changes:</strong>
If you used <code>oc edit</code>, saving the file will automatically apply the changes. If you edited the local YAML file, apply it again:</p>
<div class="literalblock">
<div class="content">
<pre>[source,bash,subs="attributes+"]
----
oc apply -f broker-basic-instance.yaml
----</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>The Operator will detect the changes, and the broker pod will likely restart to apply the new configuration.</pre>
</div>
</div>
</li>
<li>
<p><strong>Verify Configuration:</strong>
After the pod restarts and is running again, you can check the <code>status</code> section of the <code>ActiveMQArtemis</code> CR for any configuration errors.</p>
<div class="literalblock">
<div class="content">
<pre>[source,bash,subs="attributes+"]
----
oc get activemqartemis my-broker -o yaml
----</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>    Examine the `status` field for any warnings or error messages related to the `brokerProperties` or `deploymentPlan`. A healthy `status` indicates successful application of changes.
// end::hands-on-modify-broker[]
// end::managing-broker-instances[]</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_addresses_and_queues_with_activemqartemisaddress_cr"><a class="anchor" href="#_configuring_addresses_and_queues_with_activemqartemisaddress_cr"></a>Configuring Addresses and Queues with <code>ActiveMQArtemisAddress</code> CR</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Beyond the broker instance itself, you can also define addresses and queues <strong>on</strong> the broker using the <code>ActiveMQArtemisAddress</code> Custom Resource. This allows for declarative management of your messaging destinations.</p>
</div>
<div class="sect2">
<h3 id="_technical_explanation_activemqartemisaddress_cr_structure"><a class="anchor" href="#_technical_explanation_activemqartemisaddress_cr_structure"></a>Technical Explanation: <code>ActiveMQArtemisAddress</code> CR Structure</h3>
<div class="paragraph">
<p>The <code>ActiveMQArtemisAddress</code> CR allows you to define messaging addresses and their associated queues. Each CR instance configures a single address and/or queue.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>apiVersion</code>: <code>broker.amq.io/v1beta1</code></p>
</li>
<li>
<p><code>kind</code>: <code>ActiveMQArtemisAddress</code></p>
</li>
<li>
<p><code>metadata</code>: Contains the <code>name</code> (unique identifier for this address CR).</p>
</li>
<li>
<p>NOTE: If creating via the OpenShift web console, you <strong>must</strong> include a <code>namespace</code> property in the <code>metadata</code> section, specifying the name of your OpenShift project.</p>
</li>
<li>
<p><code>spec</code>: Defines the address and queue properties:</p>
</li>
<li>
<p><code>address</code>: The name of the messaging address (e.g., <code>myAddress0</code>).</p>
</li>
<li>
<p><code>queue</code>: The name of the queue to associate with the address (e.g., <code>myQueue0</code>).</p>
</li>
<li>
<p><code>routingType</code>: Specifies how messages are routed to the queue. Common types include <code>anycast</code> (for point-to-point) and <code>multicast</code> (for publish/subscribe).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This CR is installed automatically when you install the AMQ Broker Operator. For more details, refer to <a href="#https://access.redhat.com/documentation/en-us/red_hat_amq_broker/7.13/html/deploying_amq_broker_on_openshift/configuring-addresses-and-queues-in-the-activemqartemisaddress-cr">Section 4.2.1.2, “Configuring addresses and queues in the <code>ActiveMQArtemisAddress</code> CR”</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hands_on_activity_create_an_address_and_queue"><a class="anchor" href="#_hands_on_activity_create_an_address_and_queue"></a>Hands-on Activity: Create an Address and Queue</h3>
<div class="paragraph">
<p>In this activity, you will create an address and an associated <code>anycast</code> queue on your <code>my-broker</code> instance using an <code>ActiveMQArtemisAddress</code> CR.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure to Create an Address and Queue</div>
<ol class="arabic">
<li>
<p><strong>Open the OpenShift Web Console:</strong>
For this activity, we will use the OpenShift web console to demonstrate the creation process via the UI, which aligns with the provided context.</p>
</li>
<li>
<p><strong>Navigate to Custom Resource Definitions:</strong>
In the left-hand navigation pane, click on menu:Administration[Custom Resource Definitions].</p>
</li>
<li>
<p><strong>Select the <code>ActiveMQArtemisAddress</code> CRD:</strong>
Scroll down or search for <code>ActiveMQArtemisAddress</code> and click on it.</p>
</li>
<li>
<p><strong>Create a New Instance:</strong>
Click on the <code>Instances</code> tab, then click the <strong>Create ActiveMQArtemisAddress</strong> button. A YAML editor will open.</p>
</li>
<li>
<p><strong>Configure the <code>ActiveMQArtemisAddress</code> CR:</strong>
Paste the following YAML into the editor. Ensure the <code>namespace</code> in <code>metadata</code> matches your current OpenShift project.</p>
<div class="literalblock">
<div class="content">
<pre>[source,yaml,subs="attributes+"]
----
apiVersion: broker.amq.io/v1beta1
kind: ActiveMQArtemisAddress
metadata:
  name: my-first-address
  namespace: &lt;your_project_name&gt; <i class="conum" data-value="1"></i><b>(1)</b>
spec:
  brokerName: my-broker <i class="conum" data-value="2"></i><b>(2)</b>
  addressName: myAddress0
  queueName: myQueue0
  routingType: anycast
----
&lt;1&gt; **Important:** Replace `&lt;your_project_name&gt;` with the actual name of your OpenShift project. This is required when creating CRs via the console.
&lt;2&gt; Specify the `name` of the broker instance (e.g., `my-broker`) that this address and queue should be created on.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>This configuration defines an address named `myAddress0` with an `anycast` queue named `myQueue0` on the broker instance `my-broker`.</pre>
</div>
</div>
</li>
<li>
<p><strong>Create the CR:</strong>
Click the <strong>Create</strong> button at the bottom of the YAML editor.</p>
</li>
<li>
<p><strong>Verify the Address and Queue:</strong>
The Operator will process the CR and create the address and queue on your AMQ Broker. You can verify this in several ways:</p>
<div class="ulist">
<ul>
<li>
<p>Check the <code>ActiveMQArtemisAddress</code> instance status in the OpenShift console.</p>
</li>
<li>
<p>Later, once you&#8217;ve configured access to the Hawtio Management Console, you can log in and see the created address and queue directly.</p>
</li>
<li>
<p>Alternatively, you can inspect the broker&#8217;s configuration directly if you have advanced access.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_important_considerations_for_broker_instances"><a class="anchor" href="#_important_considerations_for_broker_instances"></a>Important Considerations for Broker Instances</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As you deploy and manage AMQ Broker instances, keep the following best practices and considerations in mind:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Unique Names:</strong> Each <code>ActiveMQArtemis</code> and <code>ActiveMQArtemisAddress</code> Custom Resource instance must have a unique <code>metadata.name</code> within its respective type and namespace.</p>
</li>
<li>
<p><strong>Liveness Probes:</strong> The AMQ Broker Operator enables a default liveness probe to check the health of a broker. This probe typically checks the reachability of the AMQ Management Console. If you&#8217;re configuring advanced scenarios (e.g., leader-follower HA), you might need to adjust or add custom liveness probes, as the management console might not always be reachable on follower brokers.</p>
</li>
<li>
<p><strong>Node Placement for HA (Advanced):</strong> While not explicitly covered in basic deployment, if you plan for High Availability (HA) with multiple broker deployments on the same OpenShift cluster, ensure that broker pods are provisioned on separate nodes. This prevents a single node failure from taking down both brokers. Refer to "Controlling placement of broker pods on OpenShift Container Platform nodes" for detailed guidance on node affinity and anti-affinity.</p>
</li>
<li>
<p><strong>Persistent Storage:</strong> For production environments, always set <code>persistenceEnabled: true</code> in your <code>ActiveMQArtemis</code> CR to ensure message durability. This will require configuring appropriate Persistent Volumes (PVs) and Persistent Volume Claims (PVCs) for your OpenShift environment.</p>
</li>
<li>
<p><strong>Custom Broker Properties:</strong> The <code>spec.brokerProperties</code> section in the <code>ActiveMQArtemis</code> CR allows you to configure any broker-level property that isn&#8217;t directly exposed in the CRD. This provides granular control for advanced customizations. Always check the CR <code>status</code> after modifying <code>brokerProperties</code> to ensure no errors were introduced.</p>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="understanding-amq-broker-custom-resource-definitions-crds.html">understanding-amq-broker-custom-resource-definitions-crds.adoc</a></span>
  <span class="next"><a href="monitoring-initial-broker-deployment.html">Monitoring Initial Broker Deployment</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
