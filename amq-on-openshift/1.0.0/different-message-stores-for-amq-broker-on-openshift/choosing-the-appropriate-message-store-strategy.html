<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Choosing the Appropriate Message Store Strategy :: AMQ Broker on OpenShift: Deployment and Management</title>
    <link rel="prev" href="journal-vs-paging-for-message-persistence.html">
    <link rel="next" href="openshift-storage-considerations-persistent-volumes.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">AMQ Broker on OpenShift: Deployment and Management</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="amq-on-openshift" data-version="1.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">AMQ Broker on OpenShift: Deployment and Management</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../overview-of-message-oriented-middleware/overview-of-message-oriented-middleware.html">Overview of Message-Oriented Middleware</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/introduction-to-message-oriented-middleware-mom.html">Introduction to Message-Oriented Middleware (MOM)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/benefits-and-use-cases-of-asynchronous-messaging.html">Benefits and Use Cases of Asynchronous Messaging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/core-concepts-producers-consumers-queues-topics.html">Core Concepts: Producers, Consumers, Queues, Topics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview-of-message-oriented-middleware/common-messaging-patterns-point-to-point-publishsubscribe.html">Common Messaging Patterns</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../amq-broker-overview/amq-broker-overview.html">AMQ Broker Overview</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/introduction-to-red-hat-amq-broker.html">Introduction to Red Hat AMQ Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/foundations-in-apache-activemq-artemis.html">Foundations in Apache ActiveMQ Artemis</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/key-features-and-capabilities.html">Key Features and Capabilities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/supported-messaging-protocols-jms-amqp-mqtt-stomp-openwire.html">Supported Messaging Protocols (JMS, AMQP, MQTT, STOMP, OpenWire)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-overview/amq-broker-architecture.html">AMQ Broker Architecture</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/deploying-amq-broker-on-openshift.html">Deploying AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/openshift-container-platform-fundamentals-for-amq-broker.html">OpenShift Container Platform Fundamentals for AMQ Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/introduction-to-the-amq-broker-operator.html">Introduction to the AMQ Broker Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/installing-the-amq-broker-operator-via-cli-or-operatorhub.html">Installing the AMQ Broker Operator via CLI or OperatorHub</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/understanding-amq-broker-custom-resource-definitions-crds.html">understanding-amq-broker-custom-resource-definitions-crds.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/creating-and-managing-broker-instances-with-custom-resources-crs.html">Creating and Managing Broker Instances with Custom Resources (CRs)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../deploying-amq-broker-on-openshift/monitoring-initial-broker-deployment.html">Monitoring Initial Broker Deployment</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/scaling-amq-broker-on-openshift.html">Scaling AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/concepts-of-horizontal-and-vertical-scaling.html">Concepts of Horizontal and Vertical Scaling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/scaling-broker-pods-and-replicas.html">Scaling Broker Pods and Replicas</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/adjusting-resource-allocations-cpu-memory-for-broker-pods.html">Adjusting Resource Allocations (CPU, Memory) for Broker Pods</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/performance-considerations-for-scaling.html">Performance Considerations for Scaling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scaling-amq-broker-on-openshift/best-practices-for-scaling-in-openshift.html">Best Practices for Scaling AMQ Broker on OpenShift</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../securing-amq-broker-on-openshift/securing-amq-broker-on-openshift.html">Securing AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/encrypting-connections.html">Encrypting Connections</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/configuring-ssltls-for-client-broker-communication.html">Configuring SSL/TLS for Client-Broker Communication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/managing-certificates-and-trust-stores-on-openshift.html">Managing Certificates and Trust Stores on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/enabling-secure-listeners.html">Enabling Secure Listeners</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/enabling-rbac-role-based-access-control.html">Enabling RBAC (Role-Based Access Control)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/defining-users-roles-and-permissions-in-amq-broker.html">Defining Users, Roles, and Permissions in AMQ Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/integrating-with-openshift-authentication-mechanisms.html">Integrating with OpenShift Authentication Mechanisms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/integrating-external-identity-providers-idp.html">Integrating External Identity Providers (IDP)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/overview-of-external-idp-integration-eg-ldap-keycloak.html">Overview of External IDP Integration (e.g., LDAP, Keycloak)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/configuring-amq-broker-for-external-idp-authentication.html">Configuring AMQ Broker for External Identity Provider (IDP) Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../securing-amq-broker-on-openshift/mapping-external-roles-to-broker-roles.html">Mapping External Roles to Broker Roles</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/amq-broker-high-availability-on-openshift.html">AMQ Broker High Availability on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/introduction-to-high-availability-ha-concepts.html">Introduction to High Availability (HA) Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/broker-clustering-strategies-shared-store-vs-replicated-live-backup.html">Broker Clustering Strategies: Shared Store vs. Replicated Live-Backup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/deploying-and-configuring-an-ha-broker-pair.html">Deploying and Configuring an HA Broker Pair</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/understanding-failover-and-recovery-mechanisms.html">Understanding Failover and Recovery Mechanisms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amq-broker-high-availability-on-openshift/persistence-and-data-replication-for-ha.html">Persistence and Data Replication for HA</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="different-message-stores-for-amq-broker-on-openshift.html">Different Message Stores for AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="overview-of-message-store-options.html">Overview of Message Store Options</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="file-based-message-store-configuration.html">File-Based Message Store Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jdbc-message-store-integration-with-external-databases.html">JDBC Message Store Integration with External Databases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="journal-vs-paging-for-message-persistence.html">Journal vs. Paging for Message Persistence</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="choosing-the-appropriate-message-store-strategy.html">Choosing the Appropriate Message Store Strategy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="openshift-storage-considerations-persistent-volumes.html">Storage Considerations</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/accessing-management-console-for-amq-broker-on-openshift.html">Accessing Management Console for AMQ Broker on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/introduction-to-the-hawtio-management-console.html">Introduction to the Hawtio Management Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/exposing-the-console-via-openshift-routes.html">Exposing the Hawtio Management Console via OpenShift Routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/authentication-and-authorization-for-console-access.html">Authentication and Authorization for AMQ Broker Management Console Access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/monitoring-broker-metrics-queues-and-topics.html">Monitoring Broker Metrics, Queues, and Topics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../accessing-management-console-for-amq-broker-on-openshift/performing-administrative-tasks-through-the-console.html">Performing Administrative Tasks through the Console</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/enabling-external-access-to-brokers-deployed-on-openshift.html">Enabling External Access to Brokers Deployed on OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/openshift-networking-concepts-services-routes-ingress.html">OpenShift Networking Concepts: Services, Routes, Ingress</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/exposing-broker-listeners-via-openshift-routes.html">Exposing Broker Listeners via OpenShift Routes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/configuring-client-connections-for-external-access.html">Configuring Client Connections for External Access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../enabling-external-access-to-brokers-deployed-on-openshift/security-implications-and-best-practices-for-external-access.html">Securing External Access to AMQ Broker on OpenShift</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../core-protocol-client-examples/core-protocol-client-examples.html">Core Protocol Client Examples</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/introduction-to-amq-core-protocol.html">Introduction to AMQ Core Protocol</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/setting-up-a-core-protocol-client-development-environment.html">Setting Up a Core Protocol Client Development Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/developing-producers-and-consumers-with-java-core-protocol.html">Developing Producers and Consumers with Java Core Protocol</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/implementing-point-to-point-messaging.html">Implementing Point-to-Point Messaging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core-protocol-client-examples/implementing-publishsubscribe-messaging.html">Implementing Publish/Subscribe Messaging</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../amqp-protocol-client-examples/amqp-protocol-client-examples.html">AMQP Protocol Client Examples</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/introduction-to-amqp-10-standard.html">Introduction to AMQP 1.0 Standard</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/setting-up-an-amqp-client-development-environment-eg-qpid-jms.html">Setting Up an AMQP Client Development Environment (e.g., Qpid JMS)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/developing-producers-and-consumers-with-amqp-clients-eg-java-python.html">Developing Producers and Consumers with AMQP Clients (e.g., Java, Python)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/connecting-to-amq-broker-using-amqp.html">Connecting to AMQ Broker using AMQP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amqp-protocol-client-examples/exploring-advanced-amqp-features.html">Exploring Advanced AMQP Features</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/hands-on-lab-deploying-and-managing-amq-broker.html">Hands-on Lab: Deploying and Managing AMQ Broker</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-deploying-a-basic-amq-broker-instance.html">Lab: Deploying a Basic AMQ Broker Instance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-configuring-external-access-and-testing-client-connectivity.html">Lab: Configuring External Access and Testing Client Connectivity</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-implementing-basic-security-encryption-rbac.html">Lab: Implementing Basic Security (Encryption, RBAC)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-deploying-an-ha-broker-cluster.html">Lab: Deploying an HA Broker Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-monitoring-with-the-management-console.html">Lab: Monitoring with the Management Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hands-on-lab-deploying-and-managing-amq-broker/lab-developing-and-testing-core-protocol-and-amqp-clients.html">Lab: Developing and Testing Core Protocol and AMQP Clients</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">AMQ Broker on OpenShift: Deployment and Management</span>
    <span class="version">1.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">AMQ Broker on OpenShift: Deployment and Management</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">AMQ Broker on OpenShift: Deployment and Management</a></li>
    <li><a href="different-message-stores-for-amq-broker-on-openshift.html">Different Message Stores for AMQ Broker on OpenShift</a></li>
    <li><a href="choosing-the-appropriate-message-store-strategy.html">Choosing the Appropriate Message Store Strategy</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Choosing the Appropriate Message Store Strategy</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Understanding and selecting the correct message store strategy is a critical decision for any AMQ Broker deployment, especially in containerized environments like OpenShift. The choice impacts performance, reliability, scalability, and operational complexity. This section details the primary message store options available for AMQ Broker and provides guidance on how to choose the best strategy for your specific use case.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="amq-broker-message-store-overview"><a class="anchor" href="#amq-broker-message-store-overview"></a>Overview of Message Store Options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AMQ Broker, based on Apache ActiveMQ Artemis, primarily offers two fundamental approaches for message persistence:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#file-based-message-store.adoc" class="xref unresolved">File-Based Journal</a></p>
</li>
<li>
<p><a href="#jdbc-message-store.adoc" class="xref unresolved">JDBC Message Store</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each approach has distinct characteristics, advantages, and trade-offs that are important to consider.</p>
</div>
<div class="sect2">
<h3 id="amq-broker-file-based-journal"><a class="anchor" href="#amq-broker-file-based-journal"></a>File-Based Journal Store</h3>
<div class="paragraph">
<p>The file-based journal is the default and generally recommended message store for AMQ Broker due to its high performance and efficiency.</p>
</div>
<div class="sect3">
<h4 id="_detailed_technical_explanation"><a class="anchor" href="#_detailed_technical_explanation"></a>Detailed Technical Explanation</h4>
<div class="paragraph">
<p>The file-based journal stores messages and binding data directly on the filesystem in a highly optimized binary log format. It uses a write-ahead log (WAL) approach, ensuring that data is written to disk before an acknowledgment is sent back to the producer. This design provides excellent durability while minimizing I/O overhead.</p>
</div>
<div class="paragraph">
<p>Key characteristics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Performance:</strong> The file-based journal is designed for maximum throughput and minimal latency. It uses sequential writes, which are significantly faster than random writes, making it ideal for high-volume messaging scenarios.</p>
</li>
<li>
<p><strong>Simplicity:</strong> It&#8217;s the default configuration, requiring no external database setup.</p>
</li>
<li>
<p><strong>Data Structure:</strong> Data is stored in a series of journal files (e.g., <code>activemq-data-*.amq</code>) within a configured directory.</p>
</li>
<li>
<p><strong>OpenShift Considerations:</strong> When deploying on OpenShift, the file-based journal requires persistent storage, typically provisioned via Persistent Volumes (PVs). For single instances or replicated high-availability (HA) setups, a <code>ReadWriteOnce</code> (RWO) PV is sufficient. For shared-store HA, a <code>ReadWriteMany</code> (RWX) PV is required, allowing multiple broker pods to access the same underlying storage.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="amq-broker-jdbc-message-store"><a class="anchor" href="#amq-broker-jdbc-message-store"></a>JDBC Message Store</h3>
<div class="paragraph">
<p>The JDBC message store allows AMQ Broker to persist messages and bindings to an external relational database using Java Database Connectivity (JDBC).</p>
</div>
<div class="sect3">
<h4 id="_detailed_technical_explanation_2"><a class="anchor" href="#_detailed_technical_explanation_2"></a>Detailed Technical Explanation</h4>
<div class="paragraph">
<p>Instead of writing to local journal files, the broker interacts with a database through a JDBC driver. Message and binding data are stored in database tables, encoded using the AMQ Broker journal encoding. This approach leverages the durability and transactional capabilities of the underlying database.</p>
</div>
<div class="paragraph">
<p>Key characteristics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Integration:</strong> It allows integration with existing database infrastructure and operational practices, which can be advantageous in environments with strict data management policies or existing database teams.</p>
</li>
<li>
<p><strong>Manageability:</strong> Database tools can be used for backup, recovery, and monitoring of the message store data, fitting into established enterprise IT strategies.</p>
</li>
<li>
<p><strong>Performance Overhead:</strong> As highlighted in the context, "use of a database can negatively effect the performance of a messaging system. Specifically, writing messaging data to database tables via JDBC creates a significant performance overhead for a broker." This is due to the additional latency of network communication with the database, the overhead of SQL queries, and the transactional nature of database operations compared to the highly optimized sequential writes of the file-based journal.</p>
</li>
<li>
<p><strong>Supported Databases:</strong> AMQ Broker supports various relational databases. For a definitive list, refer to the <a href="#amq-broker-supported-configurations.adoc" class="xref unresolved">Red Hat AMQ 7 Supported Configurations</a> on the Red Hat Customer Portal.</p>
</li>
<li>
<p><strong>OpenShift Considerations:</strong></p>
</li>
<li>
<p><strong>External Database:</strong> Requires an external database instance (e.g., PostgreSQL, MySQL, Oracle, MS SQL Server) accessible from the OpenShift cluster.</p>
</li>
<li>
<p><strong>JDBC Driver:</strong> The necessary JDBC driver JAR file must be made available to the broker at runtime. This typically involves using a custom image or mounting the JAR file into the broker pod. Refer to <a href="#add-third-party-jars.adoc" class="xref unresolved">Section 4.4, “Adding third-party JAR files”</a> in the AMQ Broker documentation for details.</p>
</li>
<li>
<p><strong>Secrets:</strong> Database credentials (username, password) should be managed securely using OpenShift Secrets.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="amq-broker-journal-vs-paging"><a class="anchor" href="#amq-broker-journal-vs-paging"></a>Journal vs. Paging for Message Persistence</h3>
<div class="paragraph">
<p>While not a primary "store strategy" in the same vein as file-based vs. JDBC, the concepts of "journal" and "paging" are critical to understanding AMQ Broker&#8217;s message persistence.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Journal:</strong> As discussed, the journal is the primary persistence mechanism for active, in-flight messages and binding data. It ensures durability for messages that are intended to be stored.</p>
</li>
<li>
<p><strong>Paging:</strong> Paging is a flow control mechanism that the broker uses to prevent memory exhaustion when a queue accumulates a large number of messages, or when consumers are slow. Instead of keeping all messages in memory, the broker "pages" them out to disk (using dedicated paging files on the filesystem, regardless of whether the main message store is file-based or JDBC). When consumers become available, messages are paged back into memory. Paging is always filesystem-based and is distinct from the primary message store for durability.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="amq-broker-choosing-strategy-factors"><a class="anchor" href="#amq-broker-choosing-strategy-factors"></a>Choosing the Appropriate Message Store Strategy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The decision between a file-based journal and a JDBC message store depends on several factors:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Comparison of Message Store Strategies</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top">File-Based Journal</th>
<th class="tableblock halign-left valign-top">JDBC Message Store</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Performance</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">link: #amq-broker-file-based-journal[Excellent] (high throughput, low latency)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">link: #amq-broker-jdbc-message-store[Lower] (significant overhead compared to file-based)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Simplicity</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High (default, no external database needed)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Moderate (requires external database, JDBC driver, configuration)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Integration</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Less integrated with existing database infrastructure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Highly integrated with existing database infrastructure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Data Management</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specialized tools/scripts for journal management; relies on PV snapshots for backup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard database tools for backup, recovery, monitoring</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>High Availability (HA)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong> Shared Store: Requires <code>ReadWriteMany</code> (RWX) PV.
</strong> Replicated Live-Backup: <code>ReadWriteOnce</code> (RWO) PV per broker.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong> Shared Store: Requires an external database accessible by all broker instances.
</strong> Replicated Live-Backup: Each broker instance <strong>can</strong> use the same external database, but typically replicated HA uses its own internal persistence.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpenShift Storage</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Persistent Volumes (RWO or RWX)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">External database service</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Based on these factors, consider the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Prioritize Performance:</strong> If your primary concern is maximum message throughput and lowest latency, the <strong>file-based journal</strong> is almost always the superior choice. This is the recommended default for most high-performance messaging applications.</p>
</li>
<li>
<p><strong>Leverage Existing IT Infrastructure:</strong> If your organization has strong existing database infrastructure, established operational procedures for database management (backup, monitoring, security), and a preference for centralizing data, then a <strong>JDBC message store</strong> might be a good fit, <strong>provided you can accept the performance trade-offs</strong>.</p>
</li>
<li>
<p><strong>High Availability Requirements:</strong></p>
</li>
<li>
<p>For <strong>shared-store HA</strong>, both strategies are viable. The file-based approach requires an RWX Persistent Volume, while the JDBC approach requires a shared database.</p>
</li>
<li>
<p>For <strong>replicated live-backup HA</strong>, each live broker in a replication pair has its own persistence. File-based is generally simpler as it only requires RWO PVs. If using JDBC with replicated HA, ensure your database can handle the load from multiple brokers and that replication is configured correctly.</p>
</li>
<li>
<p><strong>Operational Complexity:</strong> While JDBC can simplify data management by leveraging existing database tools, it adds complexity in terms of managing the external database, its network connectivity, and JDBC driver availability within your OpenShift deployment.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In general, for new deployments on OpenShift, especially those focused on cloud-native patterns and high performance, the <strong>file-based journal with OpenShift Persistent Volumes</strong> is often the most straightforward and performant choice.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="amq-broker-hands-on-message-store-prep"><a class="anchor" href="#amq-broker-hands-on-message-store-prep"></a>Hands-on Activity: Preparing for Message Store Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This activity focuses on understanding how message store options are specified within the <code>ActiveMQArtemis</code> Custom Resource (CR) on OpenShift, and the prerequisites for each.</p>
</div>
<div class="sect2">
<h3 id="_objective"><a class="anchor" href="#_objective"></a>Objective</h3>
<div class="ulist">
<ul>
<li>
<p>Review the structure of an <code>ActiveMQArtemis</code> CR to locate message store configuration options.</p>
</li>
<li>
<p>Identify the key parameters for configuring a file-based journal versus a JDBC message store.</p>
</li>
<li>
<p>Understand the prerequisites for a JDBC message store deployment.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_steps"><a class="anchor" href="#_steps"></a>Steps</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Log in to OpenShift:</strong>
Ensure you are logged into your OpenShift cluster using the <code>oc</code> CLI.</p>
<div class="literalblock">
<div class="content">
<pre>```bash
oc login -u &lt;your_username&gt; -p &lt;your_password&gt; &lt;your_openshift_cluster_url&gt;
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Identify Message Store Configuration in a Sample CR:</strong>
Examine a sample <code>ActiveMQArtemis</code> Custom Resource (CR). If you have an AMQ Broker Operator installed, you can get a sample or create a basic one.</p>
<div class="literalblock">
<div class="content">
<pre>Let's look at a conceptual `ActiveMQArtemis` CR snippet for a file-based store:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```yaml
apiVersion: broker.amq.io/v1beta1
kind: ActiveMQArtemis
metadata:
  name: my-broker
spec:
  deploymentPlan:
    size: 1
    image: registry.redhat.io/amq7/amq-broker-rhel8:7.12
    persistenceEnabled: true
    journalType: large_messages_optimized
    # For file-based persistence, a Persistent Volume Claim (PVC) is automatically created
    # or you can specify an existing one via `storage.pvc` field if not using default.
    # The 'journalType' field indicates the type of journal.
    # Common options:
    #   'large_messages_optimized': Optimized for large messages (default for new CRs)
    #   'nondurable_dlr': Non-durable store for delivery acknowledgements
    #   'nio': Basic Non-Blocking I/O
    #   'aio': Asynchronous I/O (Linux only, requires libaio)
  # ... other configurations
```</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Now, consider a conceptual `ActiveMQArtemis` CR snippet for a JDBC message store:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```yaml
apiVersion: broker.amq.io/v1beta1
kind: ActiveMQArtemis
metadata:
  name: jdbc-broker
spec:
  deploymentPlan:
    size: 1
    image: registry.redhat.io/amq7/amq-broker-rhel8:7.12
    persistenceEnabled: true
    # For JDBC, the journalType is implicitly handled by the 'database' configuration
    # or explicitly set to 'jdbc'.
    database:
      type: postgres
      jdbcUrl: "jdbc:postgresql://postgresql-service:5432/brokerdb"
      # Reference to a Secret containing database credentials
      databaseSecret:
        name: broker-db-secret
        userKey: database-user
        passwordKey: database-password
      # Optionally, specify a custom JDBC driver image if not included in the base image
      # jdbcDriverImage: my-custom-jdbc-driver-image:latest
      # Or, configure additional mounts for JDBC driver JARs
      externalVolumes:
        - name: jdbc-driver-volume
          mountPath: /opt/amq/drivers
          secret:
            secretName: custom-jdbc-driver-secret
  # ... other configurations
```</pre>
</div>
</div>
</li>
<li>
<p><strong>Observe Key Differences:</strong></p>
<div class="ulist">
<ul>
<li>
<p>For file-based persistence, the <code>persistenceEnabled: true</code> and <code>journalType</code> fields are primary. The OpenShift Operator handles PVC creation and mounting.</p>
</li>
<li>
<p>For JDBC persistence, the <code>database</code> section is introduced. This section specifies:</p>
</li>
<li>
<p><code>type</code>: The database type (e.g., <code>postgres</code>, <code>mysql</code>).</p>
</li>
<li>
<p><code>jdbcUrl</code>: The connection string for your database.</p>
</li>
<li>
<p><code>databaseSecret</code>: A reference to an OpenShift <code>Secret</code> containing the database username and password. This is crucial for securely managing credentials.</p>
</li>
<li>
<p><code>jdbcDriverImage</code> or <code>externalVolumes</code>: How the JDBC driver JAR file is made available to the broker pod. This is a critical prerequisite.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Consider Prerequisites for JDBC:</strong>
Before deploying an AMQ Broker with a JDBC message store, ensure the following are in place:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Dedicated Database:</strong> A running database instance (e.g., PostgreSQL, MySQL) accessible from your OpenShift cluster.</p>
</li>
<li>
<p><strong>Database Schema/User:</strong> A database and a user with appropriate permissions to create tables and perform read/write operations within that database.</p>
</li>
<li>
<p><strong>OpenShift Secret:</strong> An OpenShift <code>Secret</code> containing the database username and password.
<code><code>bash
oc create secret generic broker-db-secret \
  --from-literal=database-user=mybrokeruser \
  --from-literal=database-password=mybrokerpassword
</code></code></p>
</li>
<li>
<p><strong>JDBC Driver:</strong> The correct JDBC driver JAR file must be present in the broker&#8217;s classpath. This can be achieved by:</p>
</li>
<li>
<p>Using a custom AMQ Broker image that includes the driver.</p>
</li>
<li>
<p>Mounting the driver JAR from an <code>ConfigMap</code> or <code>Secret</code> using <code>externalVolumes</code> and ensuring it&#8217;s in the correct path for the broker to pick it up.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This hands-on exploration should solidify your understanding of how to configure and prepare for different message store strategies within an OpenShift AMQ Broker deployment.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="journal-vs-paging-for-message-persistence.html">Journal vs. Paging for Message Persistence</a></span>
  <span class="next"><a href="openshift-storage-considerations-persistent-volumes.html">Storage Considerations</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
